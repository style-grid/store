<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Post Generator (Final Update)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: #e9ecef; 
            padding: 20px; 
            color: #34495e;
        }
        /* মূল কন্টেইনারের সাইজ বাড়ানো হয়েছে */
        .container { 
            max-width: 900px; 
            margin: 0 auto 20px; /* নিচে মার্জিন দেওয়া হয়েছে যাতে আউটপুট সেকশন আলাদা হয় */
            background: white; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
        }
        h2 { 
            text-align: center; 
            color: #2c3e50; 
            margin-bottom: 25px; 
        }
        .form-group { 
            margin-bottom: 15px; 
        }
        label { 
            display: block; 
            margin-bottom: 6px; 
            font-weight: 600; 
            font-size: 14px; 
        }
        input, textarea { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #ced4da; 
            border-radius: 6px; 
            font-size: 14px; 
            transition: 0.3s; 
            box-sizing: border-box; 
        }
        input:focus, textarea:focus { 
            border-color: #1da1f2; 
            outline: none; 
            box-shadow: 0 0 5px rgba(29, 161, 242, 0.3); 
        }
        textarea { 
            height: 150px; 
            resize: vertical; 
        }
        
        /* HIDDEN FIELDS */
        .hidden-field { 
            display: none; 
        }
        
        .row { 
            display: flex; 
            gap: 15px; 
        }
        .col { 
            flex: 1; 
        }
        
        button {
            width: 100%; 
            padding: 14px; 
            background: #1da1f2; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            font-size: 16px; 
            font-weight: bold; 
            cursor: pointer; 
            margin-top: 15px;
            transition: background 0.3s, transform 0.1s;
        }
        button:hover { 
            background: #0d8bd9; 
        }
        button:active {
            transform: scale(0.99);
        }

        /* নতুন আউটপুট সেকশন - ফর্ম কার্ডের বাইরে থাকবে */
        .output-area { 
            max-width: 900px; /* ফর্ম কার্ডের মতোই চওড়া */
            margin: 20px auto; 
            position: relative; 
            display: none; 
            background: #282c34; /* প্রি কোডের ব্যাকগ্রাউন্ড */
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        pre { 
            background: transparent; 
            color: #61dafb; 
            padding: 20px; 
            padding-top: 50px; /* কপি বাটন এর জন্য স্পেস */
            border-radius: 8px; 
            overflow-x: auto; 
            white-space: pre-wrap; 
            font-family: 'Courier New', monospace; 
            font-size: 13px;
            max-height: 400px; /* স্ক্রল করার জন্য হাইট */
            overflow-y: auto;
        }
        
        .copy-btn { 
            position: absolute; 
            top: 10px; 
            right: 10px; 
            width: auto; /* বাটন ছোট করা হয়েছে */
            padding: 6px 12px; 
            font-size: 12px; 
            border: 1px solid #444;
            background: #3c4046; 
            color: #fff; 
            font-weight: normal;
            transition: background 0.3s;
            margin: 0;
        }
        .copy-btn:hover { 
            background: #50555c; 
        }
        /* কপি করার পর ফিডব্যাক স্টাইল */
        .copy-btn.copied {
            background: #28a745;
            color: white;
        }
    </style>
</head>
<body>

<div class="container">
    <h2><i class="fa-solid fa-wand-magic-sparkles"></i> Secret Binodon Post Generator</h2>
    
    <div class="form-group">
        <label>Post Title</label>
        <input type="text" id="title" placeholder="Ex: তানিয়া ভাবীর ভাইরাল ভিডিও..." required>
    </div>

    <div class="row">
        <div class="col form-group">
            <label>Thumbnail URL (Image Link)</label>
            <input type="text" id="media" value="" placeholder="এখানে থাম্বনেইল বা পোস্টের ইমেজ লিংক দিন" required>
        </div>
        <div class="col form-group">
            <label>Video Duration (HH:MM:SS)</label>
            <input type="text" id="duration" placeholder="00:10:00" value="00:05:00" required>
        </div>
    </div>

    <div class="form-group">
        <label>Article Paragraphs (এন্টার চাপলে নতুন প্যারাগ্রাফ হিসেবে গণ্য হবে)</label>
        <textarea id="paragraphs" placeholder="প্রথম প্যারাগ্রাফ। এইখানে এন্টার দিলে সেটা দ্বিতীয় প্যারাগ্রাফ হবে। উদাহরণস্বরূপ:&#10;&#10;এইটা ১ নাম্বার প্যারাগ্রাফ।&#10;এইটা ২ নাম্বার প্যারাগ্রাফ।&#10;এইটা ৩ নাম্বার প্যারাগ্রাফ।" required></textarea>
    </div>

    <div class="row">
        <div class="col form-group">
            <label>Download Link 1 (Primary)</label>
            <input type="url" id="link1" placeholder="https://example.com/download-link-1" required>
        </div>
        <div class="col form-group">
            <label>Download Link 2 (Optional)</label>
            <input type="url" id="link2" placeholder="https://example.com/download-link-2 (ঐচ্ছিক)">
        </div>
    </div>
    
    <input type="hidden" id="generatedId" class="hidden-field"> 
    <input type="hidden" id="hashtags" value="#SecretBinodon #viralvideo #trending #virallink #viral_video_2026" class="hidden-field">


    <button onclick="generateJSON()">Generate Code for posts.json</button>
</div>

<div class="output-area" id="output-box">
    <button class="copy-btn" id="copyBtn" onclick="copyCode()"><i class="fa-solid fa-copy"></i> Copy Code</button>
    <pre id="json-output"></pre>
</div>

<script>
    const usedIds = new Set();
    const ID_LENGTH = 6;
    const CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';

    function generateUniqueId() {
        let id;
        do {
            id = '';
            for (let i = 0; i < ID_LENGTH; i++) {
                id += CHARACTERS.charAt(Math.floor(Math.random() * CHARACTERS.length));
            }
        } while (usedIds.has(id)); 
        
        usedIds.add(id); 
        return id;
    }

    /**
     * রিয়েল-টাইম বাংলাদেশ সময় (GMT+6) অনুসারে ISO ফরমেটে ডেট/টাইম রিটার্ন করে।
     */
    function getCurrentISOString() {
        const date = new Date();
        const utc = date.getTime() + (date.getTimezoneOffset() * 60000);
        const bdtOffset = 6 * 60 * 60000; 
        const bdtDate = new Date(utc + bdtOffset);
        
        const Y = bdtDate.getFullYear();
        const M = String(bdtDate.getMonth() + 1).padStart(2, '0');
        const D = String(bdtDate.getDate()).padStart(2, '0');
        const h = String(bdtDate.getHours()).padStart(2, '0');
        const m = String(bdtDate.getMinutes()).padStart(2, '0');
        const s = String(bdtDate.getSeconds()).padStart(2, '0');

        return `${Y}-${M}-${D}T${h}:${m}:${s}`;
    }

    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('generatedId').value = generateUniqueId();
    });
    
    function generateJSON() {
        // ফর্ম ডেটা সংগ্রহ
        const id = document.getElementById('generatedId').value;
        const title = document.getElementById('title').value;
        const duration = document.getElementById('duration').value;
        const media = document.getElementById('media').value;
        const paraText = document.getElementById('paragraphs').value;
        const link1 = document.getElementById('link1').value;
        const link2 = document.getElementById('link2').value;
        
        // অটোমেটিক ও লুকানো ডেটা সংগ্রহ
        const uploadTime = getCurrentISOString(); 
        const hashtags = document.getElementById('hashtags').value;

        const paragraphs = paraText.split('\n').map(p => p.trim()).filter(p => p.length > 0);

        if (!title || !media || !duration || !paraText || !link1) {
             alert("অনুগ্রহ করে টাইটেল, থাম্বনেইল, ভিডিও ডিউরেশন, প্যারাগ্রাফ এবং ডাউনলোড লিংক ১ পূরণ করুন।");
             return;
        }

        const postObj = {
            id: id,
            uploadTime: uploadTime,
            title: title,
            mediaImage: media,
            paragraphs: paragraphs,
            hashtags: hashtags,
            downloadLink1: link1,
            videoDuration: duration
        };

        if (link2) postObj.downloadLink2 = link2;

        const jsonString = JSON.stringify(postObj, null, 2);
        
        // JSON আউটপুট: কমা এখন শেষে যোগ করা হবে
        document.getElementById('json-output').innerText = jsonString + "\n,";
        document.getElementById('output-box').style.display = 'block';
        
        // নতুন আইডি জেনারেট
        document.getElementById('generatedId').value = generateUniqueId(); 
    }

    /**
     * আউটপুট কোড কপি করে এবং ভিজ্যুয়াল ফিডব্যাক দেয়।
     */
    function copyCode() {
        const code = document.getElementById('json-output').innerText;
        const copyBtn = document.getElementById('copyBtn');
        
        // কপি করার জন্য কমা বাদ দেওয়া
        const codeToCopy = code.endsWith("\n,") ? code.slice(0, -2) : code;
        
        navigator.clipboard.writeText(codeToCopy).then(() => {
            // ভিজ্যুয়াল ফিডব্যাক: বাটন টেক্সট ও স্টাইল পরিবর্তন
            const originalText = copyBtn.innerHTML;
            copyBtn.innerHTML = '<i class="fa-solid fa-check"></i> Copied!';
            copyBtn.classList.add('copied');
            
            // ৩ সেকেন্ড পর আসল অবস্থায় ফিরিয়ে আনা
            setTimeout(() => {
                copyBtn.innerHTML = originalText;
                copyBtn.classList.remove('copied');
            }, 3000);
        }).catch(err => {
            console.error('Could not copy text: ', err);
            alert("কপি করা সম্ভব হয়নি।"); // যদি কোনো কারণে কপি ফেইল করে
        });
    }
</script>

</body>
</html>
