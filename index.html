<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Binodon - Home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* বেসিক স্টাইল (আগের মতই, শুধু প্রাসঙ্গিক অংশ রাখা হলো) */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; text-decoration: none; }
        body { background-color: #f0f2f5; display: flex; justify-content: center; }
        .main-container { background-color: white; width: 100%; max-width: 600px; min-height: 100vh; position: relative; }
        
        /* হেডার ও প্রোফাইল সেকশন আগের কোড থেকে নিবেন, এখানে সংক্ষেপে ফিড স্টাইল দিচ্ছি */
        .post-card { padding: 15px; border-bottom: 1px solid #e1e8ed; background: #fff; margin-bottom: 5px; }
        .post-header { display: flex; gap: 10px; align-items: center; margin-bottom: 10px; }
        .post-pfp img { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; }
        .post-meta h3 { font-size: 16px; font-weight: 700; color: #0f1419; margin: 0; }
        .post-meta span { font-size: 14px; color: #536471; }
        
        .post-title { font-size: 17px; font-weight: 700; color: #0f1419; margin-bottom: 5px; line-height: 1.3; cursor: pointer; }
        .post-excerpt { font-size: 15px; color: #0f1419; line-height: 1.4; margin-bottom: 5px; cursor: pointer; }
        .read-more { color: #1da1f2; font-weight: 500; }
        .hashtags { color: #1d9bf0; font-size: 14px; margin-bottom: 10px; }
        
        .media-container { 
            position: relative; width: 100%; border-radius: 12px; overflow: hidden; 
            margin-top: 5px; display: block; max-height: 500px; cursor: pointer; background: #000;
        }
        .media-container img { width: 100%; height: auto; display: block; object-fit: contain; max-height: 500px; margin: 0 auto; }
        .play-icon {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 50px; height: 50px; background: rgba(0,0,0,0.6); border-radius: 50%;
            display: flex; justify-content: center; align-items: center; border: 2px solid #fff;
        }
        .play-icon::after { content: ''; border-left: 15px solid white; border-top: 10px solid transparent; border-bottom: 10px solid transparent; margin-left: 5px; }

        /* ফুটার */
        .post-footer { display: flex; justify-content: space-between; margin-top: 10px; color: #536471; font-size: 14px; }
        .footer-action { display: flex; align-items: center; gap: 5px; cursor: pointer; }
        .footer-action:hover { color: #1da1f2; }
        .love-btn.liked { color: #e0245e; }
        
        /* ফিক্সড হেডার ও প্রোফাইল সেকশন (সংক্ষিপ্ত) */
        .cover-photo { height: 160px; background: #ddd; } 
        .cover-photo img { width: 100%; height: 100%; object-fit: cover; }
        .profile-header { padding: 0 15px; position: relative; margin-bottom: 15px; }
        .pfp-main { width: 110px; height: 110px; border-radius: 50%; border: 4px solid white; margin-top: -55px; position: relative; z-index: 2; overflow: hidden; background: #000;}
        .pfp-main img { width: 100%; height: 100%; }
        .info { padding: 0 15px; }
        .info h1 { font-size: 22px; font-weight: 800; }
        .info p { color: #536471; font-size: 15px; }
        .nav-bar { display: flex; border-top: 1px solid #ddd; border-bottom: 1px solid #ddd; margin-top: 10px; background: #fff; position: sticky; top: 0; z-index: 10; }
        .nav-item { flex: 1; text-align: center; padding: 12px; font-weight: 600; cursor: pointer; color: #536471; }
        .nav-item.active { color: #000; border-bottom: 3px solid #1da1f2; }
    </style>
</head>
<body>

<div class="main-container">
    <!-- প্রোফাইল এরিয়া (আগের মতোই) -->
    <div class="cover-photo"><img src="https://images.unsplash.com/photo-1531256379416-9f000e705ffa?w=800&q=80"></div>
    <div class="profile-header">
        <div class="pfp-main"><img src="https://images.unsplash.com/photo-1614680376593-902f74cf0d41?w=200"></div>
        <div style="position: absolute; right: 15px; top: 10px;">
             <!-- বাটনগুলো এখানে থাকবে -->
        </div>
    </div>
    <div class="info">
        <h1>SECRET BINODON</h1>
        <p>@SecretBinodon</p>
        <p>Total Videos <b id="total-videos">0</b> • Total Views <b id="total-views">0</b></p>
    </div>

    <div class="nav-bar">
        <div class="nav-item active">Posts</div>
        <div class="nav-item">Videos</div>
        <div class="nav-item">About</div>
    </div>

    <!-- ফিড কন্টেইনার -->
    <div id="feed-container"></div>
</div>

<script type="module">
    // ফায়ারবেস ইমপোর্ট ও কনফিগ (আগের কোড থেকে নিন)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getFirestore, doc, onSnapshot, updateDoc, increment, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

    const firebaseConfig = { 
        apiKey: "AIzaSyCAsD8wucLsudzY5oNbiixLGyjN2apdV0Q",
        authDomain: "my-ad-analytics-4560a.firebaseapp.com",
        databaseURL: "https://my-ad-analytics-4560a-default-rtdb.firebaseio.com",
        projectId: "my-ad-analytics-4560a",
        storageBucket: "my-ad-analytics-4560a.firebasestorage.app",
        messagingSenderId: "104213283950",
        appId: "1:104213283950:web:b5a25ecd54df809625127f",
        measurementId: "G-WS7QSQ9H0Y"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // হেল্পার ফাংশন
    function formatCount(n) { if(!n) return 0; return n >= 1000000 ? (n/1000000).toFixed(1)+'M' : n >= 1000 ? (n/1000).toFixed(1)+'K' : n; }
    function timeAgo(date) { /* টাইম ক্যালকুলেশন লজিক */ return "2h ago"; } // ডেমো

    async function loadFeed() {
        const res = await fetch('posts.json');
        const posts = await res.json();
        
        document.getElementById('total-videos').innerText = formatCount(posts.length);

        const container = document.getElementById('feed-container');
        container.innerHTML = '';

        posts.forEach(post => {
            // প্যারাগ্রাফের প্রথম লাইন বা অল্প অংশ নেওয়া
            const excerpt = post.paragraphs[0].substring(0, 100) + "...";
            
            const html = `
            <div class="post-card" data-id="${post.id}">
                <div class="post-header">
                    <div class="post-pfp"><img src="${post.profileImage}"></div>
                    <div class="post-meta">
                        <h3>${post.authorName}</h3>
                        <span>${post.authorHandle} · ${timeAgo(post.uploadTime)}</span>
                    </div>
                </div>
                
                <div class="post-content" onclick="openPost('${post.id}')">
                    <div class="post-title">${post.title}</div>
                    <div class="post-excerpt">${excerpt} <span class="read-more">See more</span></div>
                    <div class="hashtags">${post.hashtags}</div>
                    <div class="media-container">
                        <img src="${post.mediaImage}">
                        <div class="play-icon"></div>
                    </div>
                </div>

                <div class="post-footer">
                    <div class="footer-action view-stats"><i class="fa-solid fa-chart-simple"></i> <span>0</span> Views</div>
                    <div class="footer-action like-stats"><i class="fa-regular fa-heart"></i> <span>0</span> Likes</div>
                    <div class="footer-action"><i class="fa-solid fa-share-nodes"></i> Share</div>
                </div>
            </div>
            `;
            container.insertAdjacentHTML('beforeend', html);
            
            // ফায়ারবেস লিসেনার যুক্ত করুন (আগের লজিক অনুযায়ী)
            const viewEl = container.lastElementChild.querySelector('.view-stats span');
            onSnapshot(doc(db, "views", post.id), (s) => viewEl.innerText = formatCount(s.data()?.count || 0));
            // লাইক লিসেনারও যোগ করুন...
        });
    }

    // গ্লোবাল ফাংশন: পোস্ট ওপেন করা
    window.openPost = function(id) {
        window.location.href = `post.html?id=${id}`;
    };

    loadFeed();
</script>

</body>
</html>
